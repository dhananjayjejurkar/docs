---
title: Managing service limits and constraints in Azure
---

Before you can use EDB Cloud to deploy your clusters, your Azure subscription must meet certain service limit (or quota) requirements. By default, Azure sets a very low limit on the number of VMs, VCPUs (cores), and Public IP Addresses permitted for a particular region in your subscription.

To enable EDB Cloud to perform its operations successfully, check whether the following requirements are met.  

 * Is there enough quota for vCPU and IP addresses in your region?

 * Are there enough SKUs available in your region?

 * Are the necessary Azure resource providers registered to your subscription?

## Checking the requirements using a shell script

EDB provides an [azure-preflight](https://github.com/EnterpriseDB/cloud-utilities/blob/main/azure/azure-preflight.sh) shell script to check your subscription automatically. Before proceeding, ensure that the following utilities are installed on the server where the script is run.
 
 * jq
 * azure cli v2.26 or above

!!! Note
     Although EDB recommends using the the azure-preflight script, you can also use the Azure CLI or the Azure portal to manually check the requirements. See *Link*.

1. From the Azure CLI, run the following command to download the script.  

 ```
 git clone https://github.com/EnterpriseDB/cloud-utilities/
 ```

1. Next, run the **azure-preflight.sh** script. Replace the following variables with:
   * **Azure_region**: the Azure region where you plan to deploy the cluster
   * **pg-type**: NEED INPUTS HERE
   * **endpoint**: indicates either public or private endpoint
   * **--ha**: indicates whether NEED INPUTS HERE
   * **--with-infra**: NEED INPUTS HERE

 ```
  ./cloud-utilities/azure/azure-preflight.sh --location Azure_region --pgtype pg_type --endpoint endpoint [--ha] [--with-infra]
 ```

 For example, if you want to deploy a cluster in the eastus2 region with E2s_v3 cores, in a public network, and no existing DP cluster. Run the following command:

 ```
  ./azure-preflight.sh --location eastus2 --pgtype e2s_v3 --endpoint public --with-infra
 ```

1. The script displays whether you have adequate Azure resources.
 
 ![*Script output 1*](images/quotalimitation.png)

 ![*Script output 2*](images/SKUNotAvailable.png)

 NEED SCREENSHOT FOR 3RD OUTPUT

## Increasing resource qotas

### Increasing network quota

You can increase the number of public IP addresses for your account either by using the Azure portal, if you have appropriate privileges, or by submitting a support request. See:
 * [Request Networking quota increase at subscription level using Help + support](https://docs.microsoft.com/en-us/azure/azure-portal/supportability/networking-quota-requests#request-networking-quota-increase-at-subscription-level-using-help--support)

 * [Request networking quota increase at subscription level using Usages + quotas](https://docs.microsoft.com/en-us/azure/azure-portal/supportability/networking-quota-requests#request-networking-quota-increase-at-subscription-level-using-usages--quotas)


### Increasing virtual machine quota

You can increase the number of ESv3 Series virtual machines per region for your account either by using the Azure portal, if you have appropriate privileges, or by submitting a support request. See:

 * [Request a quota increase by region from Help + support](https://docs.microsoft.com/en-us/azure/azure-portal/supportability/regional-quota-requests#request-a-quota-increase-by-region-from-help--support)

 * [Request a quota increase by region from subscriptions](https://docs.microsoft.com/en-us/azure/azure-portal/supportability/regional-quota-requests#request-a-quota-increase-by-region-from-subscriptions)


## Fixing issues with SKU restrictions

[Open a support request](https://docs.microsoft.com/en-us/troubleshoot/azure/general/region-access-request-process) to remove SKU restrictions in the designated region.


## Registering Service Providers

If a service provider is displayed as `NotRegistered`, you can register it either from the Azure CLI or from the Azure portal.

### Registering Service Providers using the Azure CLI
If a required service provider is `NotRegistered`, you can register it using the [register command](https://docs.microsoft.com/en-us/cli/azure/provider?view=azure-cli-latest#az_provider_register)  :

```az provider register -n Provider.Name ```

Example:

```
 az provider register -n Microsoft.ContainerService
Registering is still on-going. You can monitor using 'az provider show -n Microsoft.ContainerService

```

### Registering Service Providers using Azure portal

1. In the [Azure portal](https://portal.azure.com/), select **Subscription**.
2. Select your specific subscription.
3. In navigation panel **Settings** group, select **Resource providers**.
4. Review the status of the required providers. To register a provider, select the provider, and, on the top menu, click **Register**.
